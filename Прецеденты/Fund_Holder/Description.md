# Описание прецедента: Принятие решения держателем фонда

## Рамки
Система управления грантами GrantSystem.

## Уровень
Задача, определенная пользователем.

## Основной исполнитель
Держатель фонда.

## Заинтересованные лица и их требования
- Держатель фонда — хочет зафиксировать итоговое решение по заявке с указанием результата и суммы гранта.
- Соискатель — хочет получить финальный статус по своей заявке.
- Эксперты — ожидают, что их оценки будут учтены при принятии решения (в текущем коде это не проверяется).
- Система — должна корректно прикрепить решение к заявке, изменить статус и зафиксировать факт операции.

## Предусловия
- Держатель фонда идентифицирован и аутентифицирован.
- В системе существует заявка (`Application`), доступная для принятия решения.
- Доступен сервис `GrantSystemService` для вызова операции `MakeDecision`.
- Оценки экспертов могут существовать, но в текущей реализации не требуются для вызова операции.

## Результаты (Постусловия)
- К заявке прикреплено решение (`Decision`) с полями `Result`, `GrantAmount`, `Report`.
- Статус заявки изменен на «Решение принято».
- Выполнено логирование факта принятия решения в консоль.

## Основной успешный сценарий
1. Держатель фонда определяет результат решения (строка) и сумму гранта (decimal).
2. Система вызывает операцию `GrantSystemService.MakeDecision(app, founder, result, grantAmount)`.
3. Сервис делегирует выполнение `Founder.MakeDecision(app, result, grantAmount)`.
4. Держатель фонда создает объект `Decision` с `Result`, `GrantAmount`, `Report = "Решение от: {Fio}"`.
5. Держатель фонда прикрепляет решение к заявке вызовом `Application.AttachDecision(dec)`.
6. Заявка сохраняет ссылку на `Decision` и изменяет статус на «Решение принято».
7. Выполняется логирование события в консоль (`Console.WriteLine`).
8. Сервис возвращает управление вызывающей стороне.

## Специальные требования (по текущей реализации)
- Операция атомарно прикрепляет решение и меняет статус заявки на «Решение принято».
- Выполняется консольное логирование факта принятия решения.
- Строка отчета (`Report`) формируется автоматически на основе `Founder.Fio`.
- Отсутствует валидация `result` и `grantAmount`; значения принимаются как есть.

## Список технологий и типов данных
- Язык: C#/.NET; логирование: `Console.WriteLine`.
- Сервис: `GrantSystemService.MakeDecision(Application app, Founder founder, string result, decimal grantAmount)`.
- Домен: `Founder.MakeDecision(...)` создает `Decision` и вызывает `Application.AttachDecision(dec)`.
- Модель: `Decision { decimal GrantAmount; string Result; string Report; }`.
- Статусы заявки: «Черновик» → «Подана» → «На проверке» → «Решение принято».

## Частота использования
Каждый раз при финализации рассмотрения конкретной заявки.

## Открытые вопросы
- Нужна ли валидация суммы гранта (сравнение с `RequestedAmount` и/или `Grant.MaxAmount`)?
- Следует ли ограничить допустимые значения `Result` (например, «Одобрено/Отклонено») перечислением?
- Разрешено ли повторное принятие решений и перезапись уже существующего `Decision`? Нужна ли история?
- Нужно ли проверять текущий статус заявки (например, запрещать решение, если не «На проверке»)?
- Следует ли уведомлять соискателя о принятом решении и каким образом?
- Должно ли логирование быть устойчивым (аудит в БД/журнале) вместо консоли?
